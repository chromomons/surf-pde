(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12668,        276]
NotebookOptionsPosition[     11025,        246]
NotebookOutlinePosition[     11472,        263]
CellTagsIndexPosition[     11429,        260]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[StyleBox["Importing \[OpenCurlyDoubleQuote]Differential \
Operators\[CloseCurlyDoubleQuote] and \[OpenCurlyDoubleQuote]Levelsets\
\[CloseCurlyDoubleQuote] packages",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.894052153589118*^9, 3.89405216171826*^9}, {
  3.894055786893421*^9, 3.894055801517158*^9}, {3.8940558690821047`*^9, 
  3.89405587368312*^9}},ExpressionUUID->"ea0edc35-b606-4265-9699-\
395e43cca724"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8940505621645727`*^9, 3.8940505621655493`*^9}, 
   3.894050604593351*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"3e411bda-25ff-49b6-a53b-4ffaa11368e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"<<", "\"\<surfDiffOps.wl\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "\"\<lsets.wl\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", " ", "\"\<exactSol.wl\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.894047505133978*^9, 3.894047548635592*^9}, {
   3.89404757910958*^9, 3.894047580116495*^9}, {3.894047760956635*^9, 
   3.894047761060504*^9}, {3.8940478469319553`*^9, 3.894047847318308*^9}, {
   3.894048131786591*^9, 3.894048160774885*^9}, {3.89404830523732*^9, 
   3.894048305743156*^9}, {3.894048338087756*^9, 3.894048363639758*^9}, {
   3.894048729293537*^9, 3.894048742741638*^9}, {3.894048995896347*^9, 
   3.894049000967354*^9}, {3.8940494452772083`*^9, 3.894049456811257*^9}, {
   3.894049895722288*^9, 3.8940498958895283`*^9}, {3.894049971738402*^9, 
   3.8940500098889637`*^9}, {3.894050363883071*^9, 3.8940503867223597`*^9}, {
   3.894050427216752*^9, 3.894050434695717*^9}, {3.8940505080022078`*^9, 
   3.894050526573044*^9}, {3.894050570777132*^9, 3.8940505718872967`*^9}, {
   3.8940506789141073`*^9, 3.894050698368185*^9}, {3.8940553269343224`*^9, 
   3.894055338094215*^9}, 3.89405577767004*^9, {3.89439286868647*^9, 
   3.894392870606304*^9}, {3.894393725751522*^9, 3.894393735751402*^9}, {
   3.894396729313488*^9, 3.894396729818102*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"6181be42-17e2-44bd-a52f-795418e63566"],

Cell[BoxData[
 RowBox[{
  RowBox[{"xyz", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.894052047166391*^9, 3.8940520550455933`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"c5fa93d8-f7f1-47d4-bfc5-3f96fd1259f5"],

Cell[TextData[StyleBox["Geometry info",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.894052177739088*^9, 
  3.8940521801889267`*^9}},ExpressionUUID->"92b38224-4cbf-469e-8b80-\
4b451121d11a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"phi", "=", 
   RowBox[{"phiSphereComp", "[", 
    RowBox[{"R", ",", "xyz"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"phiOut", "=", 
  RowBox[{"phiSphere", "[", 
   RowBox[{"R", ",", "xyz"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.865020804807755*^9, 3.8650208060786057`*^9}, {
   3.86502084095814*^9, 3.865020860355197*^9}, {3.8650211008375597`*^9, 
   3.865021102459173*^9}, {3.865021589216158*^9, 3.86502161732841*^9}, {
   3.865022040914009*^9, 3.865022044359612*^9}, {3.865022075045323*^9, 
   3.8650220752685547`*^9}, {3.86502245043227*^9, 3.865022467631496*^9}, {
   3.8650254020231524`*^9, 3.865025422025263*^9}, {3.865025493116914*^9, 
   3.8650255222119837`*^9}, {3.865025778526127*^9, 3.865025782667976*^9}, {
   3.86503145787849*^9, 3.8650314660734663`*^9}, {3.865031541972085*^9, 
   3.865031550309278*^9}, {3.865032055445655*^9, 3.865032073397895*^9}, {
   3.865032232126186*^9, 3.865032239633025*^9}, {3.8650323319720078`*^9, 
   3.865032385019849*^9}, 3.865530104875031*^9, {3.865530225927491*^9, 
   3.865530288254919*^9}, {3.865533211578821*^9, 3.865533308788527*^9}, {
   3.865536320742354*^9, 3.8655363588250303`*^9}, {3.8657028682289667`*^9, 
   3.865702882422188*^9}, {3.893947665579269*^9, 3.8939476715870953`*^9}, 
   3.8939477113720293`*^9, {3.893947789161501*^9, 3.893947790533876*^9}, {
   3.89394791051403*^9, 3.8939479131040373`*^9}, {3.894052236159657*^9, 
   3.894052236437895*^9}, {3.894053012942173*^9, 3.894053016821579*^9}, {
   3.89405534707863*^9, 3.8940553684143467`*^9}, {3.894055674222486*^9, 
   3.8940556745241013`*^9}, {3.8940557164947243`*^9, 3.894055728597953*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"6a3c8bd8-3fed-447b-8674-c106d96535a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "R"}], "+", 
  SqrtBox[
   RowBox[{
    SuperscriptBox["x", "2"], "+", 
    SuperscriptBox["y", "2"], "+", 
    SuperscriptBox["z", "2"]}]]}]], "Output",
 CellChangeTimes->{
  3.865032075823827*^9, 3.86503211876011*^9, 3.865032242195455*^9, 
   3.86503238719902*^9, 3.8655299097145967`*^9, 3.86553030188137*^9, 
   3.865533317196864*^9, 3.8655363623356237`*^9, 3.865702888201638*^9, {
   3.893947700493829*^9, 3.893947714133191*^9}, 3.893947751003264*^9, {
   3.893947904447051*^9, 3.893947922234831*^9}, 3.894050460514634*^9, {
   3.894050509995013*^9, 3.894050532518297*^9}, {3.8940505741279783`*^9, 
   3.894050593570939*^9}, {3.8940506576966763`*^9, 3.8940507339920053`*^9}, 
   3.894050884237973*^9, {3.894051015504425*^9, 3.894051036036892*^9}, 
   3.894051090202182*^9, 3.894051186675036*^9, 3.894051225195784*^9, 
   3.8940512864608097`*^9, 3.8940518500828953`*^9, {3.8940519022102537`*^9, 
   3.894051919427878*^9}, 3.89405207157736*^9, {3.894052115463187*^9, 
   3.89405212725132*^9}, 3.894052258397808*^9, 3.8940523692748413`*^9, 
   3.894052416359591*^9, 3.894052514457861*^9, 3.894052640661379*^9, 
   3.894052760711877*^9, 3.894053002935*^9, {3.894055361532629*^9, 
   3.894055368976445*^9}, {3.894055501477418*^9, 3.894055518321471*^9}, {
   3.894055683742119*^9, 3.894055737412052*^9}, 3.894055769043295*^9, 
   3.894055871792308*^9, 3.894057131176322*^9, 3.894393769645166*^9, {
   3.894393852707223*^9, 3.894393869743071*^9}, 3.894396732530051*^9, 
   3.894398404990526*^9, 3.8944809153487797`*^9, 3.8945575698368073`*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"2cc722eb-44a4-4992-9c74-8a44abce219b"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gradPhi", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Grad", "[", 
     RowBox[{"phi", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", " ", "=", " ", 
   RowBox[{"FullSimplify", "@", 
    RowBox[{"ComplexExpand", "[", 
     RowBox[{
      RowBox[{"gradPhi", "/", 
       RowBox[{"Norm", "[", "gradPhi", "]"}]}], ",", " ", 
      RowBox[{"Element", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "Reals"}], "]"}]}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "3", "]"}], "-", 
     RowBox[{"TensorProduct", "[", 
      RowBox[{"n", ",", "n"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.8650209758096237`*^9, 3.865021111152133*^9, {3.8650225083301153`*^9, 
   3.865022519474763*^9}, 3.8650225927652683`*^9, {3.865025710642627*^9, 
   3.86502571204873*^9}, 3.865026037852072*^9, 3.893947853077932*^9, {
   3.894052239773816*^9, 3.894052247629704*^9}, {3.894055832398315*^9, 
   3.894055837504283*^9}, {3.894057114261991*^9, 3.8940571195434027`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"90b23903-54ce-4da3-87ac-d3327662a732"],

Cell[TextData[StyleBox["Solution",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.894052195405446*^9, 3.894052196868443*^9}, {
  3.8940558547321053`*^9, 
  3.894055856909753*^9}},ExpressionUUID->"6e1f91ab-0bbb-41c3-8c40-\
5d8dde176cc5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"sinSolPoi", "[", "xyz", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8650255878150883`*^9, 3.8650255887739983`*^9}, 
   3.865025706592986*^9, 3.865026044062969*^9, {3.865026632957406*^9, 
   3.8650266379270353`*^9}, {3.8650311727342443`*^9, 3.865031195919979*^9}, 
   3.893947835476925*^9, {3.894393746919786*^9, 3.894393762351755*^9}, 
   3.894393866903748*^9},
 CellLabel->"In[11]:=",ExpressionUUID->"f2b6675c-9845-4b86-83dd-79b15af29804"],

Cell[TextData[StyleBox["Computation of RHS",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.894052203693264*^9, 
  3.894052206957197*^9}},ExpressionUUID->"b7e41657-5092-46f3-9305-\
3caa5be88164"],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "nu"}], "*", 
      RowBox[{"gammaLapl", "[", 
       RowBox[{"P", ",", "u", ",", "xyz"}], "]"}]}], "+", 
     RowBox[{"alpha", "*", "u"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.865023008008939*^9, 3.865023022345126*^9}, {
   3.8650232228301067`*^9, 3.8650232230368757`*^9}, {3.865023275792123*^9, 
   3.865023275969819*^9}, {3.865025935418352*^9, 3.865025936092537*^9}, {
   3.865026046287668*^9, 3.865026060478476*^9}, {3.865026645351877*^9, 
   3.8650266899185543`*^9}, {3.865032089489491*^9, 3.8650321163453293`*^9}, {
   3.8939477369924498`*^9, 3.893947748711458*^9}, 3.893947838686905*^9, {
   3.893947895598227*^9, 3.8939478996161213`*^9}, {3.894050878351342*^9, 
   3.89405087855129*^9}, {3.8940520390463963`*^9, 3.894052063706853*^9}, 
   3.894052123942944*^9, {3.894052903835864*^9, 3.894052920030354*^9}, {
   3.894052989610058*^9, 3.8940529960388937`*^9}, 3.894055756486*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"cbd90e87-a121-4e31-94bb-c6d14c067d93"],

Cell[TextData[StyleBox["Output",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.8940521363247833`*^9, 
  3.894052139435377*^9}},ExpressionUUID->"d38ba124-d2de-42a1-a700-\
2d490ae486f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<./json_output/fixed_surface_poisson_mathematica.json\>\"", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<phi\>\"", "->", 
       RowBox[{"ToString", "[", 
        RowBox[{"phiOut", ",", "InputForm"}], "]"}]}], ",", 
      RowBox[{"\"\<u\>\"", "->", 
       RowBox[{"ToString", "[", 
        RowBox[{"u", ",", "InputForm"}], "]"}]}], ",", 
      RowBox[{"\"\<f\>\"", "->", 
       RowBox[{"ToString", "[", 
        RowBox[{"f", ",", "InputForm"}], "]"}]}]}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.894398292612006*^9, 3.894398401533832*^9}, 
   3.8944808740404778`*^9, {3.8945575613068*^9, 3.894557565459374*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"c60b0f1e-7868-47e8-82f9-74bf13b2109e"]
},
WindowSize->{1019.25, 766.5},
WindowMargins->{{Automatic, 278.25}, {85.5, Automatic}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.0 for Linux x86 (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"cee1512b-96e0-47be-bda2-8cd0945a948e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 431, 7, 35, "Text",ExpressionUUID->"ea0edc35-b606-4265-9699-395e43cca724"],
Cell[992, 29, 297, 6, 29, "Input",ExpressionUUID->"3e411bda-25ff-49b6-a53b-4ffaa11368e3"],
Cell[1292, 37, 1408, 22, 71, "Input",ExpressionUUID->"6181be42-17e2-44bd-a52f-795418e63566"],
Cell[2703, 61, 274, 6, 29, "Input",ExpressionUUID->"c5fa93d8-f7f1-47d4-bfc5-3f96fd1259f5"],
Cell[2980, 69, 198, 4, 35, "Text",ExpressionUUID->"92b38224-4cbf-469e-8b80-4b451121d11a"],
Cell[CellGroupData[{
Cell[3203, 77, 1736, 27, 51, "Input",ExpressionUUID->"6a3c8bd8-3fed-447b-8674-c106d96535a8"],
Cell[4942, 106, 1657, 28, 36, "Output",ExpressionUUID->"2cc722eb-44a4-4992-9c74-8a44abce219b"]
}, Open  ]],
Cell[6614, 137, 1361, 34, 73, "Input",ExpressionUUID->"90b23903-54ce-4da3-87ac-d3327662a732"],
Cell[7978, 173, 242, 5, 35, "Text",ExpressionUUID->"6e1f91ab-0bbb-41c3-8c40-5d8dde176cc5"],
Cell[8223, 180, 501, 9, 29, "Input",ExpressionUUID->"f2b6675c-9845-4b86-83dd-79b15af29804"],
Cell[8727, 191, 201, 4, 35, "Text",ExpressionUUID->"b7e41657-5092-46f3-9305-3caa5be88164"],
Cell[8931, 197, 1102, 20, 29, "Input",ExpressionUUID->"cbd90e87-a121-4e31-94bb-c6d14c067d93"],
Cell[10036, 219, 191, 4, 35, "Text",ExpressionUUID->"d38ba124-d2de-42a1-a700-2d490ae486f0"],
Cell[10230, 225, 791, 19, 107, "Input",ExpressionUUID->"c60b0f1e-7868-47e8-82f9-74bf13b2109e"]
}
]
*)

